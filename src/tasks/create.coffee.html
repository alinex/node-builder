<!DOCTYPE html>
<html>
<head>
  <title>create.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "home/alex/github/node-builder/src/tasks/create.coffee";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0" /></head>
<body>
  <nav>
<div class="logo"><a href="http://alinex.github.io"
  onmouseover="logo.src='https://alinex.github.io/images/Alinex-200.png'"
  onmouseout="logo.src='https://alinex.github.io/images/Alinex-black-200.png'">
  <img name="logo" src="https://alinex.github.io/images/Alinex-black-200.png"
    width="150" title="Alinex Universe Homepage" />
  </a>
  <img src="http://alinex.github.io/images/Alinex-200.png"
    style="display:none" alt="preloading" />
</div>
<div class="links">
  <a href="http://alinex.github.io/blog"
    class="btn btn-primary"><span class="glyphicon-pencil"></span> Blog</a>
  <a href="http://alinex.github.io/develop"
    class="btn btn-primary"><span class="glyphicon-book"></span> Develop</a>
  <a href="http://alinex.github.io/code.html"
    class="btn btn-warning"><span class="glyphicon-cog"></span> Code</a>
</div>
</nav><div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#create-new-node-module">Create new node module</a>
      </div>

      <div class="heading h2">
        <a href="#node-modules">Node modules</a>
      </div>

      <div class="heading h2">
        <a href="#main-routine">Main routine</a>
      </div>

      <div class="heading h3">
        <a href="#create-the-directory">Create the directory</a>
      </div>

      <div class="heading h3">
        <a href="#create-initial-git-repository">Create initial git repository</a>
      </div>

      <div class="heading h3">
        <a href="#create-new-github-repository-if-not-existing">Create new GitHub repository if not existing</a>
      </div>

      <div class="heading h3">
        <a href="#create-new-package.json">Create new package.json</a>
      </div>

      <div class="heading h3">
        <a href="#create-a-readme.md-file">Create a README.md file</a>
      </div>

      <div class="heading h3">
        <a href="#create-an-initial-changelog">Create an initial changelog</a>
      </div>

      <div class="heading h3">
        <a href="#create-a-travis-configuration-file">Create a travis configuration file</a>
      </div>

      <div class="heading h3">
        <a href="#make-initial-commit">Make initial commit</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container" tabindex="0"><a id="fork" href="https://github.com/alinex/node-builder" title="Fork me on GitHub"></a>
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-new-node-module">
  <h1>
    <a href="#create-new-node-module" name="create-new-node-module" class="pilcrow"></a>
Create new node module
  </h1>
</div>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="node-modules">
  <h2>
    <a href="#node-modules" name="node-modules" class="pilcrow"></a>
Node modules
  </h2>
</div>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>include base modules</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">debug = <span class="hljs-built_in">require</span>(<span class="hljs-string">'debug'</span>)(<span class="hljs-string">'make:create'</span>)
async = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-async'</span>
fs = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-fs'</span>
path = <span class="hljs-built_in">require</span> <span class="hljs-string">'path'</span>
chalk = <span class="hljs-built_in">require</span> <span class="hljs-string">'chalk'</span>
{execFile} = <span class="hljs-built_in">require</span> <span class="hljs-string">'child_process'</span>
request = <span class="hljs-built_in">require</span> <span class="hljs-string">'request'</span>
prompt = <span class="hljs-built_in">require</span> <span class="hljs-string">'prompt'</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="main-routine">
  <h2>
    <a href="#main-routine" name="main-routine" class="pilcrow"></a>
Main routine
  </h2>
</div>
<p><strong>Arguments:</strong></p>
<ul>
<li><code>dir</code>
Directory to operate on</li>
<li><code>options</code>
Command specific parameters and options.</li>
<li><code>callback(err)</code>
The callback will be called just if an error occurred or with <code>null</code> if
execution finished.</li>
</ul>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-built_in">module</span>.exports.run = <span class="hljs-function"><span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  prompt.start()
  async.series [
    (cb) -&gt; createDir dir, options, cb
    (cb) -&gt; initGit dir, options, cb
    (cb) -&gt; createGitHub dir, options, cb
    (cb) -&gt; createPackage dir, options, cb
    (cb) -&gt; createTravis dir, options, cb
    (cb) -&gt; createReadme dir, options, cb
    (cb) -&gt; createChangelog dir, options, cb
    (cb) -&gt; initialCommit dir, options, cb
  ], <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
    <span class="hljs-keyword">throw</span> err <span class="hljs-keyword">if</span> err
    <span class="hljs-built_in">console</span>.log chalk.yellow <span class="hljs-string">"You may now work with the new package."</span>
    cb()

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-the-directory">
  <h3>
    <a href="#create-the-directory" name="create-the-directory" class="pilcrow"></a>
Create the directory
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">createDir</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>check if directory already exist</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> fs.existsSync dir
    <span class="hljs-keyword">if</span> options.verbose
      <span class="hljs-built_in">console</span>.log chalk.grey <span class="hljs-string">"Directory <span class="hljs-subst">#{dir}</span> already exists."</span>
    <span class="hljs-keyword">return</span> cb()
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>create directory</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Create directory <span class="hljs-subst">#{dir}</span>"</span>
  fs.mkdirs path.join(dir, <span class="hljs-string">'src'</span>), <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
    <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
    fs.mkdirs path.join(dir, <span class="hljs-string">'test'</span>, <span class="hljs-string">'mocha'</span>), cb

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-initial-git-repository">
  <h3>
    <a href="#create-initial-git-repository" name="create-initial-git-repository" class="pilcrow"></a>
Create initial git repository
  </h3>
</div>
<p>It will set the <code>options.git</code> variable to the local uri</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">initGit</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>check for existing git repository</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> options.verbose
    <span class="hljs-built_in">console</span>.log chalk.grey <span class="hljs-string">"Check for configured git"</span>
  <span class="hljs-keyword">if</span> fs.existsSync path.join dir, <span class="hljs-string">'.git'</span>
    options.git = <span class="hljs-string">'file://'</span> + fs.realpathSync dir
    <span class="hljs-keyword">return</span> cb()
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>create a new repository</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  prompt.get
    <span class="hljs-attribute">message</span>: <span class="hljs-string">"Should a git repository be initialized?"</span>
    <span class="hljs-attribute">validator</span>: <span class="hljs-regexp">/y[es]*|n[o]?/</span>,
    <span class="hljs-attribute">warning</span>: <span class="hljs-string">'You must respond with yes or no'</span>,
    <span class="hljs-attribute">default</span>: <span class="hljs-string">'yes'</span>
  , <span class="hljs-function"><span class="hljs-params">(err, input)</span> -&gt;</span>
    <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err <span class="hljs-keyword">or</span> input.question <span class="hljs-keyword">isnt</span> <span class="hljs-string">'yes'</span>
    <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Init new git repository"</span>
    debug <span class="hljs-string">"exec <span class="hljs-subst">#{dir}</span>&gt; git init"</span>
    execFile <span class="hljs-string">"git"</span>, [<span class="hljs-string">'init'</span>], {<span class="hljs-attribute">cwd</span>: dir}, <span class="hljs-function"><span class="hljs-params">(_, stdout, stderr)</span> -&gt;</span>
      <span class="hljs-built_in">console</span>.log chalk.grey stdout.trim() <span class="hljs-keyword">if</span> stdout <span class="hljs-keyword">and</span> options.verbose
      <span class="hljs-built_in">console</span>.error chalk.magenta stderr.trim() <span class="hljs-keyword">if</span> stderr
      file = path.join dir, <span class="hljs-string">'.gitignore'</span>
      <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err <span class="hljs-keyword">or</span> fs.existsSync file
      options.git = <span class="hljs-string">'file://'</span> + fs.realpathSync dir
      fs.copy path.join(GLOBAL.ROOT_DIR, <span class="hljs-string">'var/src/gitignore'</span>), file, <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
        file = path.join dir, <span class="hljs-string">'.npmignore'</span>
        <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err <span class="hljs-keyword">or</span> fs.existsSync file
        fs.copy path.join(GLOBAL.ROOT_DIR, <span class="hljs-string">'var/src/npmignore'</span>), file, cb

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-new-github-repository-if-not-existing">
  <h3>
    <a href="#create-new-github-repository-if-not-existing" name="create-new-github-repository-if-not-existing" class="pilcrow"></a>
Create new GitHub repository if not existing
  </h3>
</div>
<p>It will set the <code>options.github</code> variable</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">createGitHub</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">if</span> options.private
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>check for existing package with github url</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> options.verbose
    <span class="hljs-built_in">console</span>.log chalk.grey <span class="hljs-string">"Check for configured git"</span>
  file = path.join dir, <span class="hljs-string">'package.json'</span>
  <span class="hljs-keyword">if</span> fs.existsSync file
    <span class="hljs-keyword">try</span>
      pack = JSON.parse fs.readFileSync file
    <span class="hljs-keyword">catch</span> error
      <span class="hljs-keyword">return</span> cb <span class="hljs-keyword">new</span> Error <span class="hljs-string">"Could not load <span class="hljs-subst">#{file}</span> as valid JSON: <span class="hljs-subst">#{error.message}</span>"</span>
    <span class="hljs-keyword">unless</span> pack.repository.type <span class="hljs-keyword">is</span> <span class="hljs-string">'git'</span>
      <span class="hljs-built_in">console</span>.out chalk.yellow <span class="hljs-string">"Only git repositories can be added to github."</span>
      <span class="hljs-keyword">return</span> cb()
    <span class="hljs-built_in">console</span>.log pack.repository.url
    <span class="hljs-built_in">console</span>.log ~pack.repository.url.indexOf <span class="hljs-string">'github.com/'</span>
    <span class="hljs-keyword">if</span> ~pack.repository.url.indexOf <span class="hljs-string">'github.com/'</span>
      options.github = pack.repository.url
      <span class="hljs-keyword">return</span> cb()
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>check for other remote origin</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  debug <span class="hljs-string">"exec <span class="hljs-subst">#{dir}</span>&gt; git remote show origin"</span>
  execFile <span class="hljs-string">"git"</span>, [<span class="hljs-string">'remote'</span>, <span class="hljs-string">'show'</span>, <span class="hljs-string">'origin'</span>], {<span class="hljs-attribute">cwd</span>: dir}, <span class="hljs-function"><span class="hljs-params">(err, stdout)</span> -&gt;</span>
    <span class="hljs-keyword">unless</span> err
      <span class="hljs-built_in">console</span>.log chalk.grey stdout.trim() <span class="hljs-keyword">if</span> stdout <span class="hljs-keyword">and</span> options.verbose
      <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Skipped GitHub because other origin exists already"</span>
      <span class="hljs-keyword">return</span> cb()
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>create github repository</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    prompt.get
      <span class="hljs-attribute">message</span>: <span class="hljs-string">"Should a github repository be initialized?"</span>
      <span class="hljs-attribute">validator</span>: <span class="hljs-regexp">/y[es]*|n[o]?/</span>,
      <span class="hljs-attribute">warning</span>: <span class="hljs-string">'You must respond with yes or no'</span>,
      <span class="hljs-attribute">default</span>: <span class="hljs-string">'yes'</span>
    , <span class="hljs-function"><span class="hljs-params">(err, input)</span> -&gt;</span>
      <span class="hljs-built_in">console</span>.log input
      <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err <span class="hljs-keyword">or</span> input.question <span class="hljs-keyword">isnt</span> <span class="hljs-string">'yes'</span>
      <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Init new git repository"</span>
      prompt.get [{
        <span class="hljs-attribute">message</span>: <span class="hljs-string">"GitHub username:"</span>
        <span class="hljs-attribute">name</span>: <span class="hljs-string">'username'</span>
        <span class="hljs-attribute">required</span>: <span class="hljs-literal">true</span>
        <span class="hljs-attribute">default</span>: <span class="hljs-string">'alinex'</span>
      }, {
        <span class="hljs-attribute">message</span>: <span class="hljs-string">"Password for GitHub login:"</span>
        <span class="hljs-attribute">name</span>: <span class="hljs-string">'password'</span>
        <span class="hljs-attribute">hidden</span>: <span class="hljs-literal">true</span>
        <span class="hljs-attribute">required</span>: <span class="hljs-literal">true</span>
      }, {
        <span class="hljs-attribute">message</span>: <span class="hljs-string">"Give a short description of this module."</span>
        <span class="hljs-attribute">name</span>: <span class="hljs-string">'description'</span>
        <span class="hljs-attribute">required</span>: <span class="hljs-literal">true</span>
      }], <span class="hljs-function"><span class="hljs-params">(err, input)</span> -&gt;</span>
        gitname = path.basename dir
        options.github = <span class="hljs-string">"https://github.com/<span class="hljs-subst">#{input.username}</span>/<span class="hljs-subst">#{gitname}</span>"</span>
        request {
          <span class="hljs-attribute">uri</span>: <span class="hljs-string">"https://api.github.com/repos/<span class="hljs-subst">#{input.username}</span>/<span class="hljs-subst">#{gitname}</span>"</span>
          <span class="hljs-attribute">auth</span>:
            <span class="hljs-attribute">user</span>: input.username
            <span class="hljs-attribute">pass</span>: input.password
          <span class="hljs-attribute">headers</span>:
            <span class="hljs-string">'User-Agent'</span>: input.username
        }, <span class="hljs-function"><span class="hljs-params">(err, response)</span> -&gt;</span>
          <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
          answer = JSON.parse response.body
          <span class="hljs-keyword">unless</span> answer.message?
            <span class="hljs-keyword">return</span> cb()
          <span class="hljs-keyword">unless</span> answer.message <span class="hljs-keyword">is</span> <span class="hljs-string">'Not Found'</span>
            <span class="hljs-keyword">return</span> cb answer.message
          <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Create new GitHub repository"</span>
          debug <span class="hljs-string">"POST https://api.github.com/user/repos"</span>
          request {
            <span class="hljs-attribute">uri</span>: <span class="hljs-string">"https://api.github.com/user/repos"</span>
            <span class="hljs-attribute">auth</span>:
              <span class="hljs-attribute">user</span>: input.username
              <span class="hljs-attribute">pass</span>: input.password
            <span class="hljs-attribute">headers</span>:
              <span class="hljs-string">'User-Agent'</span>: input.username
            <span class="hljs-attribute">method</span>: <span class="hljs-string">'POST'</span>
            <span class="hljs-attribute">body</span>: JSON.stringify
              <span class="hljs-attribute">name</span>: gitname
              <span class="hljs-attribute">description</span>: input.description
              <span class="hljs-attribute">homepage</span>: <span class="hljs-string">"http://<span class="hljs-subst">#{input.username}</span>.github.io/<span class="hljs-subst">#{gitname}</span>"</span>
              <span class="hljs-attribute">private</span>: <span class="hljs-literal">false</span>
              <span class="hljs-attribute">has_issues</span>: <span class="hljs-literal">true</span>
              <span class="hljs-attribute">has_wiki</span>: <span class="hljs-literal">false</span>
              <span class="hljs-attribute">has_downloads</span>: <span class="hljs-literal">true</span>
          }, <span class="hljs-function"><span class="hljs-params">(err, response)</span> -&gt;</span>
            <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
            <span class="hljs-keyword">unless</span> response?.statusCode <span class="hljs-keyword">is</span> <span class="hljs-number">201</span>
              <span class="hljs-keyword">return</span> cb <span class="hljs-string">"GitHub status was <span class="hljs-subst">#{response.statusCode}</span> in try to create repository"</span>
            <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Connect with GitHub repository"</span>
            debug <span class="hljs-string">"exec <span class="hljs-subst">#{dir}</span>&gt; git remote add origin <span class="hljs-subst">#{options.github}</span>"</span>
            execFile <span class="hljs-string">"git"</span>, [
              <span class="hljs-string">'remote'</span>
              <span class="hljs-string">'add'</span>, <span class="hljs-string">'origin'</span>, options.github
            ], {<span class="hljs-attribute">cwd</span>: dir}, <span class="hljs-function"><span class="hljs-params">(err, stdout, stderr)</span> -&gt;</span>
              <span class="hljs-built_in">console</span>.log chalk.grey stdout.trim() <span class="hljs-keyword">if</span> stdout <span class="hljs-keyword">and</span> options.verbose
              <span class="hljs-built_in">console</span>.error chalk.magenta stderr.trim() <span class="hljs-keyword">if</span> stderr
              cb err

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-new-package.json">
  <h3>
    <a href="#create-new-package.json" name="create-new-package.json" class="pilcrow"></a>
Create new package.json
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">createPackage</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>check if package.json exists</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> options.verbose
    <span class="hljs-built_in">console</span>.log chalk.grey <span class="hljs-string">"Check for existing package.json"</span>
  file = path.join dir, <span class="hljs-string">'package.json'</span>
  <span class="hljs-keyword">if</span> fs.existsSync file
    <span class="hljs-built_in">console</span>.log chalk.yellow <span class="hljs-string">"Skipped package.json creation, because already exists"</span>
    <span class="hljs-keyword">return</span> cb()
  <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Create new package.json file"</span>
  gitname = path.basename dir
  gituser = path.basename path.dirname options.github
  pack =
    <span class="hljs-attribute">name</span>: options.package
    <span class="hljs-attribute">version</span>: <span class="hljs-string">'0.0.0'</span>
    <span class="hljs-attribute">description</span>: <span class="hljs-string">''</span>
    <span class="hljs-attribute">copyright</span>: <span class="hljs-string">"<span class="hljs-subst">#{PKG.author?.name ? <span class="hljs-string">''</span>}</span> <span class="hljs-subst">#{(<span class="hljs-keyword">new</span> Date()).getFullYear()}</span>"</span>
    <span class="hljs-attribute">private</span>: options.private ? <span class="hljs-literal">false</span>
    <span class="hljs-attribute">keywords</span>: []
    <span class="hljs-attribute">homepage</span>: <span class="hljs-keyword">if</span> options.github <span class="hljs-keyword">then</span> <span class="hljs-string">"http://<span class="hljs-subst">#{gituser}</span>.github.io/<span class="hljs-subst">#{gitname}</span>/"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">""</span>
    <span class="hljs-attribute">repository</span>:
      <span class="hljs-attribute">type</span>: <span class="hljs-string">'git'</span>
      <span class="hljs-attribute">url</span>: options.github ? options.git
    <span class="hljs-attribute">bugs</span>: <span class="hljs-keyword">if</span> options.github <span class="hljs-keyword">then</span> <span class="hljs-string">"<span class="hljs-subst">#{options.github}</span>/issues"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">""</span>
    <span class="hljs-attribute">author</span>: PKG.author
    <span class="hljs-attribute">contributors</span>: []
    <span class="hljs-attribute">license</span>: PKG.license
    <span class="hljs-attribute">main</span>: <span class="hljs-string">'./lib/index.js'</span>
    <span class="hljs-attribute">scripts</span>:
      <span class="hljs-attribute">prepublish</span>: <span class="hljs-string">"node_modules/.bin/builder -c compile --uglify"</span>
      <span class="hljs-attribute">test</span>: <span class="hljs-string">"node_modules/.bin/builder -c test"</span>
    <span class="hljs-attribute">directories</span>:
      <span class="hljs-attribute">lib</span>: <span class="hljs-string">'./lib'</span>
    <span class="hljs-attribute">dependencies</span>: {}
    <span class="hljs-attribute">devDependencies</span>:
      <span class="hljs-string">"alinex-builder"</span>: <span class="hljs-string">"1.x"</span>
      <span class="hljs-string">"chai"</span>: <span class="hljs-string">"2.x"</span>
    <span class="hljs-attribute">optionalDependencies</span>: {}
    <span class="hljs-attribute">engines</span>: PKG.engines
    <span class="hljs-attribute">os</span>: []
  fs.writeFile file, JSON.stringify(pack, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>), cb

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-a-readme.md-file">
  <h3>
    <a href="#create-a-readme.md-file" name="create-a-readme.md-file" class="pilcrow"></a>
Create a README.md file
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">createReadme</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> options.verbose
    <span class="hljs-built_in">console</span>.log chalk.grey <span class="hljs-string">"Check for README.md"</span>
  file = path.join dir, <span class="hljs-string">'README.md'</span>
  <span class="hljs-keyword">if</span> fs.existsSync file
    <span class="hljs-keyword">return</span> cb()
  <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Create new README.md file"</span>
  gitname = path.basename dir
  gituser = path.basename path.dirname options.github
  doc =
    <span class="hljs-attribute">badges</span>: <span class="hljs-string">''</span>
    <span class="hljs-attribute">install</span>: <span class="hljs-string">''</span>
  <span class="hljs-keyword">if</span> options.github
    doc.badges = <span class="hljs-string">"\n[![Build Status]\
    (https://travis-ci.org/<span class="hljs-subst">#{gituser}</span>/<span class="hljs-subst">#{gitname}</span>.svg?branch=master)]\
    (https://travis-ci.org/<span class="hljs-subst">#{gituser}</span>/<span class="hljs-subst">#{gitname}</span>)
    \n[![Coverage Status]\
    (https://coveralls.io/repos/<span class="hljs-subst">#{gituser}</span>/<span class="hljs-subst">#{gitname}</span>/badge.png?branch=master)]\
    (https://coveralls.io/r/<span class="hljs-subst">#{gituser}</span>/<span class="hljs-subst">#{gitname}</span>?branch=master)"</span>
  <span class="hljs-keyword">unless</span> options.private
    doc.badges += <span class="hljs-string">"\n[![Dependency Status]\
    (https://gemnasium.com/<span class="hljs-subst">#{gituser}</span>/<span class="hljs-subst">#{gitname}</span>.png)]\
    (https://gemnasium.com/<span class="hljs-subst">#{gituser}</span>/<span class="hljs-subst">#{gitname}</span>)"</span>
    doc.install = <span class="hljs-string">"\n\
    [![NPM](https://nodei.co/npm/<span class="hljs-subst">#{options.package}</span>.png?downloads=true&amp;stars=true)]\
    (https://nodei.co/npm/<span class="hljs-subst">#{options.package}</span>/)"</span>

  fs.writeFile file, <span class="hljs-string">"""
    Package: <span class="hljs-subst">#{options.package}</span>
    =================================================
</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>{doc.badges}</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">
    Description comes here...


    Install
    -------------------------------------------------
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>{doc.install}</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">

    License
    -------------------------------------------------

    Copyright <span class="hljs-comment">#{(new Date()).getFullYear()} Alexander Schilling</span>

    Licensed under the Apache License, Version <span class="hljs-number">2.0</span> (the <span class="hljs-string">"License"</span>);
    you may <span class="hljs-keyword">not</span> use <span class="hljs-keyword">this</span> file except <span class="hljs-keyword">in</span> compliance with the License.
    You may obtain a copy <span class="hljs-keyword">of</span> the License at

    &gt;  &lt;<span class="hljs-attribute">http</span>:<span class="hljs-regexp">//</span>www.apache.org/licenses/LICENSE-<span class="hljs-number">2.0</span>&gt;

    Unless required <span class="hljs-keyword">by</span> applicable law <span class="hljs-keyword">or</span> agreed to <span class="hljs-keyword">in</span> writing, software
    distributed under the License <span class="hljs-keyword">is</span> distributed <span class="hljs-literal">on</span> an <span class="hljs-string">"AS IS"</span> BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express <span class="hljs-keyword">or</span> implied.
    See the License <span class="hljs-keyword">for</span> the specific language governing permissions <span class="hljs-keyword">and</span>
    limitations under the License.

    <span class="hljs-string">""", cb

</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-an-initial-changelog">
  <h3>
    <a href="#create-an-initial-changelog" name="create-an-initial-changelog" class="pilcrow"></a>
Create an initial changelog
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">createChangelog</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> options.verbose
    <span class="hljs-built_in">console</span>.log chalk.grey <span class="hljs-string">"Check for existing changelog"</span>
  file = path.join dir, <span class="hljs-string">'Changelog.md'</span>
  <span class="hljs-keyword">if</span> fs.existsSync file
    <span class="hljs-keyword">return</span> cb()
  <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Create new changelog file"</span>
  fs.writeFile file, <span class="hljs-string">"""
    Version changes
    =================================================

    The following list gives a short overview about what is changed between
    individual versions:


    """</span>, cb

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-a-travis-configuration-file">
  <h3>
    <a href="#create-a-travis-configuration-file" name="create-a-travis-configuration-file" class="pilcrow"></a>
Create a travis configuration file
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">createTravis</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  <span class="hljs-keyword">unless</span> options.github
    <span class="hljs-keyword">return</span> cb()
  <span class="hljs-keyword">if</span> options.verbose
    <span class="hljs-built_in">console</span>.log chalk.grey <span class="hljs-string">"Check for existing travis configuration"</span>
  file = path.join dir, <span class="hljs-string">'.travis.yml'</span>
  <span class="hljs-keyword">if</span> fs.existsSync file
    <span class="hljs-keyword">return</span> cb()
  gituser = path.basename path.dirname options.github
  <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Create new travis-ci configuration"</span>
  <span class="hljs-built_in">console</span>.log chalk.yellow.bold <span class="hljs-string">"Log into https://travis-ci.org/profile/<span class="hljs-subst">#{gituser}</span>
    and activate Travis CI"</span>
  <span class="hljs-built_in">console</span>.log chalk.yellow.bold <span class="hljs-string">"Log into https://coveralls.io/repos/new?name=<span class="hljs-subst">#{gituser}</span>
    and activate coveralls"</span>
  <span class="hljs-built_in">console</span>.log chalk.yellow.bold <span class="hljs-string">"Log into https://gemnasium.com/projects/new_from_github
    and activate dependency checks"</span>
  coveralls = <span class="hljs-string">"
    COVERALLS_SERVICE_NAME=travis-ci
    COVERALLS_REPO_TOKEN=haQKkRgwLHbwX1dp8ltFXFTPO48c5EEWo
    node_modules/.bin/builder -c test --coverage --coveralls"</span>
  fs.writeFile file, <span class="hljs-string">"""
    language: node_js
    node_js:
       - "0.10" # from 2013-03 maintenance till 2016-10
       - "0.12" # from 2015-02 maintenance till 2017-04
       - "4.2"  # LTS from 2015-10  maintenance till 2018-04
       - "5.5"  # current
    after_success:
       - <span class="hljs-subst">#{coveralls}</span>
    """</span>, cb

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="make-initial-commit">
  <h3>
    <a href="#make-initial-commit" name="make-initial-commit" class="pilcrow"></a>
Make initial commit
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">initialCommit</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> options.verbose
    <span class="hljs-built_in">console</span>.log chalk.grey <span class="hljs-string">"Check if git already used"</span>
  debug <span class="hljs-string">"exec <span class="hljs-subst">#{dir}</span>&gt; git log"</span>
  execFile <span class="hljs-string">"git"</span>, [ <span class="hljs-string">'log'</span> ], {<span class="hljs-attribute">cwd</span>: dir}, <span class="hljs-function"><span class="hljs-params">(err, stdout)</span> -&gt;</span>
    <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">if</span> stdout.trim()
    <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Initial commit"</span>
    debug <span class="hljs-string">"exec <span class="hljs-subst">#{dir}</span>&gt; git add *"</span>
    execFile <span class="hljs-string">"git"</span>, [ <span class="hljs-string">'add'</span>, <span class="hljs-string">'*'</span> ], {<span class="hljs-attribute">cwd</span>: dir}, <span class="hljs-function"><span class="hljs-params">(err, stdout, stderr)</span> -&gt;</span>
      <span class="hljs-built_in">console</span>.log chalk.grey stdout.trim() <span class="hljs-keyword">if</span> stdout <span class="hljs-keyword">and</span> options.verbose
      <span class="hljs-built_in">console</span>.error chalk.magenta stderr.trim() <span class="hljs-keyword">if</span> stderr
      debug <span class="hljs-string">"exec <span class="hljs-subst">#{dir}</span>&gt; git commit -m \"Initial commit\""</span>
      execFile <span class="hljs-string">"git"</span>, [ <span class="hljs-string">'commit'</span>, <span class="hljs-string">'-m'</span>, <span class="hljs-string">'Initial commit'</span> ]
      , {<span class="hljs-attribute">cwd</span>: dir}, <span class="hljs-function"><span class="hljs-params">(err, stdout, stderr)</span> -&gt;</span>
        <span class="hljs-built_in">console</span>.log chalk.grey stdout.trim() <span class="hljs-keyword">if</span> stdout <span class="hljs-keyword">and</span> options.verbose
        <span class="hljs-built_in">console</span>.error chalk.magenta stderr.trim() <span class="hljs-keyword">if</span> stderr
        <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Push to origin"</span>
        debug <span class="hljs-string">"exec <span class="hljs-subst">#{dir}</span>&gt; git push origin master"</span>
        execFile <span class="hljs-string">"git"</span>, [ <span class="hljs-string">'push'</span>, <span class="hljs-string">'origin'</span>, <span class="hljs-string">'master'</span> ],
        {<span class="hljs-attribute">cwd</span>: dir}, <span class="hljs-function"><span class="hljs-params">(err, stdout, stderr)</span> -&gt;</span>
          <span class="hljs-built_in">console</span>.log chalk.grey stdout.trim() <span class="hljs-keyword">if</span> stdout <span class="hljs-keyword">and</span> options.verbose
          <span class="hljs-built_in">console</span>.error chalk.magenta stderr.trim() <span class="hljs-keyword">if</span> stderr
          cb()

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
