<!DOCTYPE html>
<html>
<head>
  <title>create.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "src/command/create.coffee";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0" /></head>
<body>
  <nav>
<div class="logo"><a href="http://alinex.github.io"
  onmouseover="logo.src='https://alinex.github.io/images/Alinex-200.png'"
  onmouseout="logo.src='https://alinex.github.io/images/Alinex-black-200.png'">
  <img name="logo" src="https://alinex.github.io/images/Alinex-black-200.png"
    width="150" title="Alinex Universe Homepage" />
  </a>
  <img src="http://alinex.github.io/images/Alinex-200.png"
    style="display:none" alt="preloading" />
</div>
<div class="links">
  <a href="http://alinex.github.io/blog"
    class="btn btn-primary"><span class="glyphicon-pencil"></span> Blog</a>
  <a href="http://alinex.github.io/develop"
    class="btn btn-primary"><span class="glyphicon-book"></span> Develop</a>
  <a href="http://alinex.github.io/code.html"
    class="btn btn-warning"><span class="glyphicon-cog"></span> Code</a>
</div>
</nav><div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#test-script">Test Script</a>
      </div>

      <div class="heading h2">
        <a href="#node-modules">Node modules</a>
      </div>

      <div class="heading h2">
        <a href="#setup">Setup</a>
      </div>

      <div class="heading h2">
        <a href="#handler">Handler</a>
      </div>

      <div class="heading h2">
        <a href="#helper">Helper</a>
      </div>

      <div class="heading h3">
        <a href="#create-initial-git-repository">Create initial git repository</a>
      </div>

      <div class="heading h3">
        <a href="#create-new-github-repository-if-not-existing">Create new GitHub repository if not existing</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container" tabindex="0"><a id="fork" href="https://github.com/alinex/node-builder" title="Fork me on GitHub"></a>
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="test-script">
  <h1>
    <a href="#test-script" name="test-script" class="pilcrow"></a>
Test Script
  </h1>
</div>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="node-modules">
  <h2>
    <a href="#node-modules" name="node-modules" class="pilcrow"></a>
Node modules
  </h2>
</div>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>include base modules</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">chalk = <span class="hljs-built_in">require</span> <span class="hljs-string">'chalk'</span>
path = <span class="hljs-built_in">require</span> <span class="hljs-string">'path'</span>
inquirer = <span class="hljs-built_in">require</span> <span class="hljs-string">'inquirer'</span>
request = <span class="hljs-built_in">require</span> <span class="hljs-string">'request'</span>
async = <span class="hljs-built_in">require</span> <span class="hljs-string">'async'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>include alinex modules</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">fs = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-fs'</span>
util = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-util'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>internal mhelper modules</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">builder = <span class="hljs-built_in">require</span> <span class="hljs-string">'../index'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="setup">
  <h2>
    <a href="#setup" name="setup" class="pilcrow"></a>
Setup
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">
exports.title = <span class="hljs-string">'create a new package (interactive)'</span>
exports.description = <span class="hljs-string">"""
This command will create a new package and will therefore ask you some questions
interactively to do this.
"""</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="handler">
  <h2>
    <a href="#handler" name="handler" class="pilcrow"></a>
Handler
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">
exports.handler = <span class="hljs-function"><span class="hljs-params">(options, cb)</span> -&gt;</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>step over directories</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  dir = path.resolve options._[<span class="hljs-number">1</span>]
  <span class="hljs-keyword">unless</span> dir
    err = <span class="hljs-keyword">new</span> Error <span class="hljs-string">"Missing directory to create"</span>
    err.exit = <span class="hljs-number">2</span>
    <span class="hljs-keyword">return</span> cb err
  builder.info dir, options, <span class="hljs-string">"started on <span class="hljs-subst">#{dir}</span>"</span>
  ask dir, options, <span class="hljs-function"><span class="hljs-params">(err, data)</span> -&gt;</span>
    <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
    util.extend options, data
    options.message = <span class="hljs-string">"Initial setup of new project"</span>
    async.series [
      (cb) -&gt; createDir dir, options, cb
      (cb) -&gt; initGit dir, options, cb
      (cb) -&gt; createNodePackage dir, options, cb
      (cb) -&gt; updatePackageJson dir, options, cb
      (cb) -&gt; initGitHub dir, options, cb
      (cb) -&gt; builder.task <span class="hljs-string">'gitCommitAll'</span>, dir, options, cb
      (cb) -&gt; builder.task <span class="hljs-string">'gitPush'</span>, dir, options, cb
    ], <span class="hljs-function"><span class="hljs-params">(err, results)</span> -&gt;</span>
      builder.results dir, options, <span class="hljs-string">"Results for <span class="hljs-subst">#{path.basename dir}</span>"</span>, results
      builder.info dir, options, <span class="hljs-string">'done'</span>
      cb err</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="helper">
  <h2>
    <a href="#helper" name="helper" class="pilcrow"></a>
Helper
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function">
<span class="hljs-title">ask</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  builder.info dir, options, <span class="hljs-string">"get information"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>check system</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  async.parallel
    <span class="hljs-attribute">hasDir</span>: <span class="hljs-function"><span class="hljs-params">(cb)</span> -&gt;</span> fs.exists dir, <span class="hljs-function"><span class="hljs-params">(exists)</span> -&gt;</span> cb <span class="hljs-literal">null</span>, exists
    <span class="hljs-attribute">hasGit</span>: <span class="hljs-function"><span class="hljs-params">(cb)</span> -&gt;</span> fs.exists <span class="hljs-string">"<span class="hljs-subst">#{dir}</span>/.git"</span>, <span class="hljs-function"><span class="hljs-params">(exists)</span> -&gt;</span> cb <span class="hljs-literal">null</span>, exists
    <span class="hljs-attribute">hasPack</span>: <span class="hljs-function"><span class="hljs-params">(cb)</span> -&gt;</span> fs.exists <span class="hljs-string">"<span class="hljs-subst">#{dir}</span>/package.json"</span>, <span class="hljs-function"><span class="hljs-params">(exists)</span> -&gt;</span> cb <span class="hljs-literal">null</span>, exists
    <span class="hljs-attribute">pack</span>: <span class="hljs-function"><span class="hljs-params">(cb)</span> -&gt;</span> builder.task <span class="hljs-string">'packageJson'</span>, dir, options, <span class="hljs-function"><span class="hljs-params">(err, pack)</span> -&gt;</span> cb <span class="hljs-literal">null</span>, pack
  , <span class="hljs-function"><span class="hljs-params">(err, system)</span> -&gt;</span>
    <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
    system.pack ?= {}</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>ask what to do</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    builder.debug dir, options, <span class="hljs-string">"ask interactive"</span>
    <span class="hljs-built_in">console</span>.log()
    inquirer.prompt [
      <span class="hljs-attribute">type</span>: <span class="hljs-string">'input'</span>
      <span class="hljs-attribute">name</span>: <span class="hljs-string">'name'</span>
      <span class="hljs-attribute">message</span>: <span class="hljs-string">"Give a package name like alinex-...:"</span>
      <span class="hljs-attribute">when</span>: <span class="hljs-function">-&gt;</span> <span class="hljs-keyword">not</span> system.pack.name
    ,
      <span class="hljs-attribute">type</span>: <span class="hljs-string">'input'</span>
      <span class="hljs-attribute">name</span>: <span class="hljs-string">'description'</span>
      <span class="hljs-attribute">message</span>: <span class="hljs-string">"Give a short description:"</span>
      <span class="hljs-attribute">when</span>: <span class="hljs-function">-&gt;</span> <span class="hljs-keyword">not</span> system.pack.description
    ,
      <span class="hljs-attribute">type</span>: <span class="hljs-string">'confirm'</span>
      <span class="hljs-attribute">name</span>: <span class="hljs-string">'private'</span>
      <span class="hljs-attribute">message</span>: <span class="hljs-string">"Should this be kept private?"</span>
      <span class="hljs-attribute">default</span>: <span class="hljs-literal">false</span>
      <span class="hljs-attribute">when</span>: <span class="hljs-function">-&gt;</span> <span class="hljs-keyword">not</span> system.pack.private?
    ,
      <span class="hljs-attribute">type</span>: <span class="hljs-string">'confirm'</span>
      <span class="hljs-attribute">name</span>: <span class="hljs-string">'initGit'</span>
      <span class="hljs-attribute">message</span>: <span class="hljs-string">"Should a git repository be initialized?"</span>
      <span class="hljs-attribute">when</span>: <span class="hljs-function">-&gt;</span> <span class="hljs-keyword">not</span> system.hasGit
    ,
      <span class="hljs-attribute">type</span>: <span class="hljs-string">'confirm'</span>
      <span class="hljs-attribute">name</span>: <span class="hljs-string">'initGithub'</span>
      <span class="hljs-attribute">message</span>: <span class="hljs-string">"Should a github repository be used?"</span>
      <span class="hljs-attribute">when</span>: <span class="hljs-function"><span class="hljs-params">(answer)</span> -&gt;</span> answer.initGit <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> (system.pack.private <span class="hljs-keyword">or</span> answer.private)
    ,
      <span class="hljs-attribute">type</span>: <span class="hljs-string">'input'</span>
      <span class="hljs-attribute">name</span>: <span class="hljs-string">'user'</span>
      <span class="hljs-attribute">message</span>: <span class="hljs-string">"Your github username:"</span>
      <span class="hljs-attribute">default</span>: <span class="hljs-string">'alinex'</span>
      <span class="hljs-attribute">when</span>: <span class="hljs-function"><span class="hljs-params">(answer)</span> -&gt;</span> answer.initGithub
    ,
      <span class="hljs-attribute">type</span>: <span class="hljs-string">'password'</span>
      <span class="hljs-attribute">name</span>: <span class="hljs-string">'password'</span>
      <span class="hljs-attribute">message</span>: <span class="hljs-string">"Your password for github:"</span>
      <span class="hljs-attribute">when</span>: <span class="hljs-function"><span class="hljs-params">(answer)</span> -&gt;</span> answer.initGithub
    ]
    .<span class="hljs-keyword">then</span> (answer) -&gt;
      answer.pack =
        <span class="hljs-attribute">name</span>: answer.name
      <span class="hljs-keyword">delete</span> answer.name
      <span class="hljs-built_in">console</span>.log()
      cb <span class="hljs-literal">null</span>, util.extend system, answer</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>add bottombar</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function">
<span class="hljs-title">createDir</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">if</span> options.hasDir
  builder.info dir, options, <span class="hljs-string">"create folder if neccessary"</span>
  fs.mkdirs dir, <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span> cb err</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-initial-git-repository">
  <h3>
    <a href="#create-initial-git-repository" name="create-initial-git-repository" class="pilcrow"></a>
Create initial git repository
  </h3>
</div>
<p>It will set the <code>options.git</code> variable to the local uri</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">initGit</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">unless</span> options.initGit
  builder.info dir, options, <span class="hljs-string">"initialize git"</span>
  builder.exec dir, options, <span class="hljs-string">"git init"</span>,
    <span class="hljs-attribute">cmd</span>: <span class="hljs-string">'git'</span>
    <span class="hljs-attribute">args</span>: [<span class="hljs-string">'init'</span>]
    <span class="hljs-attribute">cwd</span>: dir
  , <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
    <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
    async.filter [
      path.resolve __dirname, <span class="hljs-string">'../../var/src/template/git'</span>
      path.resolve __dirname, <span class="hljs-string">'../../var/local/template/git'</span>
    ], <span class="hljs-function"><span class="hljs-params">(file, cb)</span> -&gt;</span>
      fs.exists file, <span class="hljs-function"><span class="hljs-params">(exists)</span> -&gt;</span> cb <span class="hljs-literal">null</span>, exists
    , <span class="hljs-function"><span class="hljs-params">(err, files)</span> -&gt;</span>
      <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
      <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">unless</span> files.length
      async.each files, <span class="hljs-function"><span class="hljs-params">(file, cb)</span> -&gt;</span>
        builder.debug dir, options, <span class="hljs-string">"copy template from <span class="hljs-subst">#{file}</span>"</span>
        fs.copy file, path.join(dir),
          <span class="hljs-attribute">overwrite</span>: <span class="hljs-literal">true</span>
        , cb
      , cb
    , cb
<span class="hljs-function">
<span class="hljs-title">createNodePackage</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">if</span> options.hasPack
  builder.info dir, options, <span class="hljs-string">"create node package"</span>
  async.filter [
    path.resolve __dirname, <span class="hljs-string">'../../var/src/template/node'</span>
    path.resolve __dirname, <span class="hljs-string">'../../var/local/template/node'</span>
  ], <span class="hljs-function"><span class="hljs-params">(file, cb)</span> -&gt;</span>
    fs.exists file, <span class="hljs-function"><span class="hljs-params">(exists)</span> -&gt;</span> cb <span class="hljs-literal">null</span>, exists
  , <span class="hljs-function"><span class="hljs-params">(err, files)</span> -&gt;</span>
    <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
    <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">unless</span> files.length
    async.each files, <span class="hljs-function"><span class="hljs-params">(file, cb)</span> -&gt;</span>
      builder.debug dir, options, <span class="hljs-string">"copy template from <span class="hljs-subst">#{file}</span>"</span>
      fs.copy file, path.join(dir),
        <span class="hljs-attribute">overwrite</span>: <span class="hljs-literal">true</span>
      , cb
    , <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
      <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
      fs.find dir,
        <span class="hljs-attribute">type</span>: <span class="hljs-string">'file'</span>
        <span class="hljs-attribute">exclude</span>: <span class="hljs-string">'**/.git/**'</span>
      , <span class="hljs-function"><span class="hljs-params">(err, list)</span> -&gt;</span>
        <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
        async.each list, <span class="hljs-function"><span class="hljs-params">(file, cb)</span> -&gt;</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>read, replace</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">          builder.noisy dir, options, <span class="hljs-string">"replace variables in <span class="hljs-subst">#{file}</span>"</span>
          fs.readFile file, <span class="hljs-string">'utf8'</span>, <span class="hljs-function"><span class="hljs-params">(err, content)</span> -&gt;</span>
            content = content.replace <span class="hljs-regexp">/###&lt;year&gt;###/g</span>, (<span class="hljs-keyword">new</span> Date()).getFullYear()
            content = content.replace <span class="hljs-regexp">/###&lt;pack&gt;###/g</span>, options.pack.name
            content = content.replace <span class="hljs-regexp">/###&lt;user&gt;###/g</span>, options.user
            content = content.replace <span class="hljs-regexp">/###&lt;username&gt;###/g</span>, options.username
            content = content.replace <span class="hljs-regexp">/###&lt;dirname&gt;###/g</span>, path.basename dir
            content = content.replace <span class="hljs-regexp">/###&lt;title&gt;###/g</span>,
            options.pack.name.split(<span class="hljs-regexp">/-/</span>).map(<span class="hljs-function"><span class="hljs-params">(e)</span> -&gt;</span> util.string.ucFirst e). join <span class="hljs-string">' '</span>
            fs.writeFile file, content, <span class="hljs-string">'utf8'</span>, cb
        , cb
<span class="hljs-function">
<span class="hljs-title">updatePackageJson</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">if</span> options.hasPack
  builder.info dir, options, <span class="hljs-string">"update package.json"</span>
  <span class="hljs-keyword">return</span> cb()
  setup =
    <span class="hljs-attribute">description</span>: options.description
    <span class="hljs-attribute">copyright</span>: <span class="hljs-string">"<span class="hljs-subst">#{options.user}</span> <span class="hljs-subst">#{(<span class="hljs-keyword">new</span> Date()).getFullYear()}</span>"</span>
  setup.private = options.private <span class="hljs-keyword">if</span> options.private?
  setup.homepage = <span class="hljs-string">"http://<span class="hljs-subst">#{options.user}</span>.github.io/<span class="hljs-subst">#{path.basename dir}</span>/"</span> <span class="hljs-keyword">if</span> options.initGithub
  setup.repository = {}
  <span class="hljs-keyword">if</span> options.hasGit <span class="hljs-keyword">or</span> options.initGit
    setup.repository.type = <span class="hljs-string">'git'</span>
    setup.repository.url = <span class="hljs-keyword">if</span> options.initGithub
      <span class="hljs-string">"https://github.com/<span class="hljs-subst">#{options.user}</span>/<span class="hljs-subst">#{path.basename dir}</span>"</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-string">"file://<span class="hljs-subst">#{dir}</span>"</span>
    <span class="hljs-keyword">if</span> options.initGithub
      setup.bugs = <span class="hljs-string">"https://<span class="hljs-subst">#{options.user}</span>.github.io/<span class="hljs-subst">#{path.basename dir}</span>/issues"</span>
  util.extend options.pack, setup
  cb()</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-new-github-repository-if-not-existing">
  <h3>
    <a href="#create-new-github-repository-if-not-existing" name="create-new-github-repository-if-not-existing" class="pilcrow"></a>
Create new GitHub repository if not existing
  </h3>
</div>
<p>It will set the <code>options.github</code> variable</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">initGitHub</span> = <span class="hljs-params">(dir, options, cb)</span> -&gt;</span>
  <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">unless</span> options.initGithub
  builder.info dir, options, <span class="hljs-string">"initialize github"</span>
  builder.exec dir, options, <span class="hljs-string">"git remote"</span>,
    <span class="hljs-attribute">cmd</span>: <span class="hljs-string">'git'</span>
    <span class="hljs-attribute">args</span>: [<span class="hljs-string">'remote'</span>, <span class="hljs-string">'show'</span>, <span class="hljs-string">'origin'</span>]
    <span class="hljs-attribute">cwd</span>: dir
  , <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
    <span class="hljs-keyword">unless</span> err
      <span class="hljs-built_in">console</span>.warn chalk.magenta <span class="hljs-string">"Skipped GitHub because other origin exists already"</span>
      <span class="hljs-keyword">return</span> cb()
      builder.detail dir, options, <span class="hljs-string">"check github repository"</span>
      builder.noisy dir, options, <span class="hljs-string">"GET https://api.github.com/user/repos"</span>
      request {
        <span class="hljs-attribute">uri</span>: <span class="hljs-string">"https://api.github.com/repos/<span class="hljs-subst">#{options.user}</span>/<span class="hljs-subst">#{path.basename dir}</span>"</span>
        <span class="hljs-attribute">auth</span>:
          <span class="hljs-attribute">user</span>: options.user
          <span class="hljs-attribute">pass</span>: options.password
        <span class="hljs-attribute">headers</span>:
          <span class="hljs-string">'User-Agent'</span>: options.user
      }, <span class="hljs-function"><span class="hljs-params">(err, response)</span> -&gt;</span>
        <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
        answer = JSON.parse response.body
        <span class="hljs-keyword">unless</span> answer.message?
          <span class="hljs-keyword">return</span> cb <span class="hljs-keyword">new</span> Error <span class="hljs-string">'No response from github'</span>
        <span class="hljs-keyword">unless</span> answer.message <span class="hljs-keyword">is</span> <span class="hljs-string">'Not Found'</span>
          <span class="hljs-keyword">return</span> cb <span class="hljs-keyword">new</span> Error answer.message
        builder.detail dir, options, <span class="hljs-string">"create github repository"</span>
        builder.noisy dir, options, <span class="hljs-string">"POST https://api.github.com/user/repos"</span>
        request {
          <span class="hljs-attribute">uri</span>: <span class="hljs-string">"https://api.github.com/user/repos"</span>
          <span class="hljs-attribute">auth</span>:
            <span class="hljs-attribute">user</span>: options.user
            <span class="hljs-attribute">pass</span>: options.password
          <span class="hljs-attribute">headers</span>:
            <span class="hljs-string">'User-Agent'</span>: options.user
          <span class="hljs-attribute">method</span>: <span class="hljs-string">'POST'</span>
          <span class="hljs-attribute">body</span>: JSON.stringify
            <span class="hljs-attribute">name</span>: path.basename dir
            <span class="hljs-attribute">description</span>: options.description
            <span class="hljs-attribute">homepage</span>: <span class="hljs-string">"http://<span class="hljs-subst">#{options.user}</span>.github.io/<span class="hljs-subst">#{path.basename dir}</span>"</span>
            <span class="hljs-attribute">private</span>: <span class="hljs-literal">false</span>
            <span class="hljs-attribute">has_issues</span>: <span class="hljs-literal">true</span>
            <span class="hljs-attribute">has_wiki</span>: <span class="hljs-literal">false</span>
            <span class="hljs-attribute">has_downloads</span>: <span class="hljs-literal">true</span>
        }, <span class="hljs-function"><span class="hljs-params">(err, response)</span> -&gt;</span>
          <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
          <span class="hljs-keyword">unless</span> response?.statusCode <span class="hljs-keyword">is</span> <span class="hljs-number">201</span>
            <span class="hljs-keyword">return</span> cb <span class="hljs-keyword">new</span> Error <span class="hljs-string">"GitHub status was <span class="hljs-subst">#{response.statusCode}</span> in try
            to create repository"</span>
          builder.detail dir, options, <span class="hljs-string">"set github as origin"</span>
          builder.exec dir, options, <span class="hljs-string">'git remote add'</span>,
            <span class="hljs-attribute">cmd</span>: <span class="hljs-string">'git'</span>
            <span class="hljs-attribute">args</span>: [
              <span class="hljs-string">'remote'</span>, <span class="hljs-string">'add'</span>
              <span class="hljs-string">'origin'</span>, <span class="hljs-string">"https://github.com/<span class="hljs-subst">#{options.user}</span>/<span class="hljs-subst">#{path.basename dir}</span>"</span>
            ]
            <span class="hljs-attribute">cwd</span>: dir
          , cb</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
